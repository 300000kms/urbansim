

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Statistical Models &mdash; urbansim 3.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Supply and Demand Accounting" href="supplydemand.html" />
    <link rel="prev" title="Core Models" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> urbansim
          

          
          </a>

          
            
            
              <div class="version">
                3.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Core Models</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#introduction">Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#contents">Contents</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Statistical Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-expressions">Model Expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yaml-persistence">YAML Persistence</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="supplydemand.html">Supply and Demand Accounting</a></li>
<li class="toctree-l3"><a class="reference internal" href="transrelo.html">Transition and Relocation Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="util.html">Model Related Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="urbanchoice.html">Location Choice Utilities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Real Estate Development Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">UrbanSim Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maps/index.html">DataFrame Explorer</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">urbansim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Core Models</a> &raquo;</li>
        
      <li>Statistical Models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/models/statistical.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="statistical-models">
<span id="id1"></span><h1>Statistical Models<a class="headerlink" href="#statistical-models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>UrbanSim has two sets of statistical models: regressions and
discrete choice models.
Each has a three stage usage pattern:</p>
<ol class="arabic simple">
<li><p>Create a configured model instance. This is where you will supply
most of the information to the model such as the actual definition
of the model and any filters that restrict the data used during
fitting and prediction.</p></li>
<li><p>Fit the model by supplying base year data.</p></li>
<li><p>Make predictions based on new data.</p></li>
</ol>
</div>
<div class="section" id="model-expressions">
<h2>Model Expressions<a class="headerlink" href="#model-expressions" title="Permalink to this headline">¶</a></h2>
<p>Statistical models require specification of a “model expression” that
describes the model as a mathematical formula.
UrbanSim uses <a class="reference external" href="http://patsy.readthedocs.org/">patsy</a> to interpret
model expressions, but UrbanSim gives you some flexibility
as to how you define them.</p>
<p><a class="reference external" href="http://patsy.readthedocs.org/">patsy</a> works with string formula like this simplified regression example
(names refer to columns in the <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/dsintro.html#dataframe">DataFrames</a> used during fitting and prediction):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="s1">&#39;np.log1p(sqft_price) ~ I(year_built &lt; 1940) + dist_hwy + ave_income&#39;</span>
</pre></div>
</div>
<p>In UrbanSim that same formula could be expressed in a dictionary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;left_side&#39;</span><span class="p">:</span> <span class="s1">&#39;np.log1p(sqft_price)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;right_side&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;I(year_built &lt; 1940)&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_hwy&#39;</span><span class="p">,</span> <span class="s1">&#39;ave_income&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Formulae used with location choice models have only a right hand side
since the models do not predict new numeric values. Right-hand-side formulae
can be written as lists or dictionaries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;right_side&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;I(year_built &lt; 1940)&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_hwy&#39;</span><span class="p">,</span> <span class="s1">&#39;ave_income&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">expr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;I(year_built &lt; 1940)&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_hwy&#39;</span><span class="p">,</span> <span class="s1">&#39;ave_income&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Expressing the formula as a string is always an option.
The ability to use lists or dictionaries are especially useful to make
attractively formatted formulae in <a class="reference internal" href="#yaml-config"><span class="std std-ref">YAML config files</span></a>.</p>
</div>
<div class="section" id="yaml-persistence">
<span id="yaml-config"></span><h2>YAML Persistence<a class="headerlink" href="#yaml-persistence" title="Permalink to this headline">¶</a></h2>
<p>UrbanSim’s regression and location choice models can be saved as
<a class="reference external" href="http://en.wikipedia.org/wiki/YAML">YAML</a> files and loaded again
at another time.
This feature is especially useful for estimating models in one location,
saving the fit parameters to disk, and then using the fitted model for
prediction somewhere else.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">.to_yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">.from_yaml</span></code> methods to save files to disk
and load them back as configured models.
Here’s an example of loading a regression model, performing fitting, and
saving the model back to YAML:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RegressionModel</span><span class="o">.</span><span class="n">from_yaml</span><span class="p">(</span><span class="s1">&#39;my_model.yaml&#39;</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">(</span><span class="s1">&#39;my_model.yaml&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can, if you like, write your model configurations entirely in
YAML and load them into Python only for fitting and prediction.</p>
</div>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="regression-api">
<h3>Regression API<a class="headerlink" href="#regression-api" title="Permalink to this headline">¶</a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#urbansim.models.regression.RegressionModel" title="urbansim.models.regression.RegressionModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RegressionModel</span></code></a>(fit_filters, …[, …])</p></td>
<td><p>A hedonic (regression) model with the ability to store an estimated model and predict new data based on the model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#urbansim.models.regression.SegmentedRegressionModel" title="urbansim.models.regression.SegmentedRegressionModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SegmentedRegressionModel</span></code></a>(segmentation_col[, …])</p></td>
<td><p>A regression model group that allows segments to have different model expressions and ytransforms but all have the same filters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#urbansim.models.regression.RegressionModelGroup" title="urbansim.models.regression.RegressionModelGroup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RegressionModelGroup</span></code></a>(segmentation_col[, name])</p></td>
<td><p>Manages a group of regression models that refer to different segments within a single table.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="discrete-choice-api">
<h3>Discrete Choice API<a class="headerlink" href="#discrete-choice-api" title="Permalink to this headline">¶</a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#urbansim.models.dcm.MNLDiscreteChoiceModel" title="urbansim.models.dcm.MNLDiscreteChoiceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MNLDiscreteChoiceModel</span></code></a>(model_expression, …)</p></td>
<td><p>A discrete choice model with the ability to store an estimated model and predict new data based on the model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel" title="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SegmentedMNLDiscreteChoiceModel</span></code></a>(…[, …])</p></td>
<td><p>An MNL LCM group that allows segments to have different model expressions but otherwise share configurations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup" title="urbansim.models.dcm.MNLDiscreteChoiceModelGroup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MNLDiscreteChoiceModelGroup</span></code></a>(segmentation_col)</p></td>
<td><p>Manages a group of discrete choice models that refer to different segments of choosers.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-urbansim.models.regression">
<span id="regression-api-docs"></span><h3>Regression API Docs<a class="headerlink" href="#module-urbansim.models.regression" title="Permalink to this headline">¶</a></h3>
<p>Use the <code class="docutils literal notranslate"><span class="pre">RegressionModel</span></code> class to fit a model using statsmodels’
OLS capability and then do subsequent prediction.</p>
<dl class="py class">
<dt id="urbansim.models.regression.RegressionModel">
<em class="property">class </em><code class="sig-prename descclassname">urbansim.models.regression.</code><code class="sig-name descname">RegressionModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fit_filters</span></em>, <em class="sig-param"><span class="n">predict_filters</span></em>, <em class="sig-param"><span class="n">model_expression</span></em>, <em class="sig-param"><span class="n">ytransform</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A hedonic (regression) model with the ability to store an
estimated model and predict new data based on the model.</p>
<p>statsmodels’ OLS implementation is used.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>fit_filters</strong><span class="classifier">list of str</span></dt><dd><p>Filters applied before fitting the model.</p>
</dd>
<dt><strong>predict_filters</strong><span class="classifier">list of str</span></dt><dd><p>Filters applied before calculating new data points.</p>
</dd>
<dt><strong>model_expression</strong><span class="classifier">str or dict</span></dt><dd><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.</p>
</dd>
<dt><strong>ytransform</strong><span class="classifier">callable, optional</span></dt><dd><p>A function to call on the array of predicted output.
For example, if the model relation is predicting the log
of price, you might pass <code class="docutils literal notranslate"><span class="pre">ytransform=np.exp</span></code> so that
the results reflect actual price.</p>
<p>By default no transformation is applied.</p>
</dd>
<dt><strong>name</strong><span class="classifier">optional</span></dt><dd><p>Optional descriptive name for this model that may be used
in output.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.assert_fitted">
<code class="sig-name descname">assert_fitted</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.assert_fitted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.assert_fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises a RuntimeError if the model is not ready for prediction.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.columns_used">
<code class="sig-name descname">columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the columns used in this model for filtering
and in the model expression.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model to data and store/return the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Data to use for fitting the model. Must contain all the
columns referenced by the <cite>model_expression</cite>.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool</span></dt><dd><p>If debug is set to true, this sets the attribute “est_data”
to a dataframe with the actual data used for estimation of
this model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fit</strong><span class="classifier">statsmodels.regression.linear_model.OLSResults</span></dt><dd><p>This is returned for inspection, but also stored on the
class instance for use during prediction.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.fit_from_cfg">
<em class="property">classmethod </em><code class="sig-name descname">fit_from_cfg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">cfgname</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">outcfgname</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.fit_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.fit_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">DataFrame</span></dt><dd><p>The dataframe which contains the columns to use for the estimation.</p>
</dd>
<dt><strong>cfgname</strong><span class="classifier">string</span></dt><dd><p>The name of the yaml config file which describes the hedonic model.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">boolean, optional (default False)</span></dt><dd><p>Whether to generate debug information on the model.</p>
</dd>
<dt><strong>outcfgname</strong><span class="classifier">string, optional (default cfgname)</span></dt><dd><p>The name of the output yaml config file where estimation results are written into.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>RegressionModel which was used to fit</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.fitted">
<em class="property">property </em><code class="sig-name descname">fitted</code><a class="headerlink" href="#urbansim.models.regression.RegressionModel.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the model is ready for prediction.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.from_yaml">
<em class="property">classmethod </em><code class="sig-name descname">from_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">yaml_str</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">str_or_buffer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a RegressionModel instance from a saved YAML configuration.
Arguments are mutually exclusive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>yaml_str</strong><span class="classifier">str, optional</span></dt><dd><p>A YAML string from which to load model.</p>
</dd>
<dt><strong>str_or_buffer</strong><span class="classifier">str or file like, optional</span></dt><dd><p>File name or buffer from which to load YAML.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>RegressionModel</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict a new data set based on an estimated model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Data to use for prediction. Must contain all the columns
referenced by the right-hand side of the <cite>model_expression</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier">pandas.Series</span></dt><dd><p>Predicted values as a pandas Series. Will have the index of <cite>data</cite>
after applying filters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.predict_from_cfg">
<em class="property">classmethod </em><code class="sig-name descname">predict_from_cfg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">cfgname</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.predict_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.predict_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">DataFrame</span></dt><dd><p>The dataframe which contains the columns to use for the estimation.</p>
</dd>
<dt><strong>cfgname</strong><span class="classifier">string</span></dt><dd><p>The name of the yaml config file which describes the hedonic model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>predicted</strong><span class="classifier">pandas.Series</span></dt><dd><p>Predicted data in a pandas Series. Will have the index of <cite>data</cite>
after applying filters and minus any groups that do not have
models.</p>
</dd>
<dt><strong>hm</strong><span class="classifier">RegressionModel which was used to predict</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.report_fit">
<code class="sig-name descname">report_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.report_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.report_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a report of the fit results.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.str_model_expression">
<em class="property">property </em><code class="sig-name descname">str_model_expression</code><a class="headerlink" href="#urbansim.models.regression.RegressionModel.str_model_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Model expression as a string suitable for use with patsy/statsmodels.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.to_dict">
<code class="sig-name descname">to_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary representation of a RegressionModel instance.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModel.to_yaml">
<code class="sig-name descname">to_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">str_or_buffer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.to_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.to_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a model respresentation to YAML.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>str_or_buffer</strong><span class="classifier">str or file like, optional</span></dt><dd><p>By default a YAML string is returned. If a string is
given here the YAML will be written to that file.
If an object with a <code class="docutils literal notranslate"><span class="pre">.write</span></code> method is given the
YAML will be written to that object.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>j</strong><span class="classifier">str</span></dt><dd><p>YAML string if <cite>str_or_buffer</cite> is not given.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="urbansim.models.regression.RegressionModelGroup">
<em class="property">class </em><code class="sig-prename descclassname">urbansim.models.regression.</code><code class="sig-name descname">RegressionModelGroup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">segmentation_col</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Manages a group of regression models that refer to different segments
within a single table.</p>
<p>Model names must match the segment names after doing a Pandas groupby.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>segmentation_col</strong></dt><dd><p>Name of the column on which to segment.</p>
</dd>
<dt><strong>name</strong></dt><dd><p>Optional name used to identify the model in places.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="urbansim.models.regression.RegressionModelGroup.add_model">
<code class="sig-name descname">add_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">model</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup.add_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.add_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a <cite>RegressionModel</cite> instance.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>model</strong><span class="classifier"><cite>RegressionModel</cite></span></dt><dd><p>Should have a <code class="docutils literal notranslate"><span class="pre">.name</span></code> attribute matching one of
the groupby segments.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModelGroup.add_model_from_params">
<code class="sig-name descname">add_model_from_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">fit_filters</span></em>, <em class="sig-param"><span class="n">predict_filters</span></em>, <em class="sig-param"><span class="n">model_expression</span></em>, <em class="sig-param"><span class="n">ytransform</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup.add_model_from_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.add_model_from_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a model by passing arguments through to <cite>RegressionModel</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name</strong><span class="classifier">any</span></dt><dd><p>Must match a groupby segment name.</p>
</dd>
<dt><strong>fit_filters</strong><span class="classifier">list of str</span></dt><dd><p>Filters applied before fitting the model.</p>
</dd>
<dt><strong>predict_filters</strong><span class="classifier">list of str</span></dt><dd><p>Filters applied before calculating new data points.</p>
</dd>
<dt><strong>model_expression</strong><span class="classifier">str</span></dt><dd><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.</p>
</dd>
<dt><strong>ytransform</strong><span class="classifier">callable, optional</span></dt><dd><p>A function to call on the array of predicted output.
For example, if the model relation is predicting the log
of price, you might pass <code class="docutils literal notranslate"><span class="pre">ytransform=np.exp</span></code> so that
the results reflect actual price.</p>
<p>By default no transformation is applied.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModelGroup.columns_used">
<code class="sig-name descname">columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the columns used across all models in the group
for filtering and in the model expression.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModelGroup.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit each of the models in the group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Must have a column with the same name as <cite>segmentation_col</cite>.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool</span></dt><dd><p>If set to true (default false) will pass the debug parameter
to model estimation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fits</strong><span class="classifier">dict of statsmodels.regression.linear_model.OLSResults</span></dt><dd><p>Keys are the segment names.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModelGroup.fitted">
<em class="property">property </em><code class="sig-name descname">fitted</code><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether all models in the group have been fitted.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.RegressionModelGroup.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict new data for each group in the segmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Data to use for prediction. Must have a column with the
same name as <cite>segmentation_col</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>predicted</strong><span class="classifier">pandas.Series</span></dt><dd><p>Predicted data in a pandas Series. Will have the index of <cite>data</cite>
after applying filters and minus any groups that do not have
models.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="urbansim.models.regression.SegmentedRegressionModel">
<em class="property">class </em><code class="sig-prename descclassname">urbansim.models.regression.</code><code class="sig-name descname">SegmentedRegressionModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">segmentation_col</span></em>, <em class="sig-param"><span class="n">fit_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">predict_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">default_model_expr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">default_ytransform</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_segment_size</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A regression model group that allows segments to have different
model expressions and ytransforms but all have the same filters.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>segmentation_col</strong></dt><dd><p>Name of column in the data table on which to segment. Will be used
with a pandas groupby on the data table.</p>
</dd>
<dt><strong>fit_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied before fitting the model.</p>
</dd>
<dt><strong>predict_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied before calculating new data points.</p>
</dd>
<dt><strong>min_segment_size</strong><span class="classifier">int</span></dt><dd><p>This model will add all segments that have at least this number of
observations. A very small number of observations (e.g. 1) will
cause an error with estimation.</p>
</dd>
<dt><strong>default_model_expr</strong><span class="classifier">str or dict, optional</span></dt><dd><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.</p>
</dd>
<dt><strong>default_ytransform</strong><span class="classifier">callable, optional</span></dt><dd><p>A function to call on the array of predicted output.
For example, if the model relation is predicting the log
of price, you might pass <code class="docutils literal notranslate"><span class="pre">ytransform=np.exp</span></code> so that
the results reflect actual price.</p>
<p>By default no transformation is applied.</p>
</dd>
<dt><strong>min_segment_size</strong><span class="classifier">int, optional</span></dt><dd><p>Segments with less than this many members will be skipped.</p>
</dd>
<dt><strong>name</strong><span class="classifier">str, optional</span></dt><dd><p>A name used in places to identify the model.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.add_segment">
<code class="sig-name descname">add_segment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">model_expression</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ytransform</span><span class="o">=</span><span class="default_value">'default'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.add_segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.add_segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new segment with its own model expression and ytransform.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name :</strong></dt><dd><p>Segment name. Must match a segment in the groupby of the data.</p>
</dd>
<dt><strong>model_expression</strong><span class="classifier">str or dict, optional</span></dt><dd><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.
If not given the default model will be used, which must not be
None.</p>
</dd>
<dt><strong>ytransform</strong><span class="classifier">callable, optional</span></dt><dd><p>A function to call on the array of predicted output.
For example, if the model relation is predicting the log
of price, you might pass <code class="docutils literal notranslate"><span class="pre">ytransform=np.exp</span></code> so that
the results reflect actual price.</p>
<p>If not given the default ytransform will be used.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.columns_used">
<code class="sig-name descname">columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the columns used across all models in the group
for filtering and in the model expression.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit each segment. Segments that have not already been explicitly
added will be automatically added with default model and ytransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Must have a column with the same name as <cite>segmentation_col</cite>.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool</span></dt><dd><p>If set to true will pass debug to the fit method of each model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fits</strong><span class="classifier">dict of statsmodels.regression.linear_model.OLSResults</span></dt><dd><p>Keys are the segment names.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.fit_from_cfg">
<em class="property">classmethod </em><code class="sig-name descname">fit_from_cfg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">cfgname</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">min_segment_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outcfgname</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.fit_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.fit_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">DataFrame</span></dt><dd><p>The dataframe which contains the columns to use for the estimation.</p>
</dd>
<dt><strong>cfgname</strong><span class="classifier">string</span></dt><dd><p>The name of the yaml config file which describes the hedonic model.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">boolean, optional (default False)</span></dt><dd><p>Whether to generate debug information on the model.</p>
</dd>
<dt><strong>min_segment_size</strong><span class="classifier">int, optional</span></dt><dd><p>Set attribute on the model.</p>
</dd>
<dt><strong>outcfgname</strong><span class="classifier">string, optional (default cfgname)</span></dt><dd><p>The name of the output yaml config file where estimation results are written into.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hm</strong><span class="classifier">SegmentedRegressionModel which was used to fit</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.fitted">
<em class="property">property </em><code class="sig-name descname">fitted</code><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether models for all segments have been fit.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.from_yaml">
<em class="property">classmethod </em><code class="sig-name descname">from_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">yaml_str</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">str_or_buffer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a SegmentedRegressionModel instance from a saved YAML
configuration. Arguments are mutally exclusive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>yaml_str</strong><span class="classifier">str, optional</span></dt><dd><p>A YAML string from which to load model.</p>
</dd>
<dt><strong>str_or_buffer</strong><span class="classifier">str or file like, optional</span></dt><dd><p>File name or buffer from which to load YAML.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>SegmentedRegressionModel</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict new data for each group in the segmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Data to use for prediction. Must have a column with the
same name as <cite>segmentation_col</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>predicted</strong><span class="classifier">pandas.Series</span></dt><dd><p>Predicted data in a pandas Series. Will have the index of <cite>data</cite>
after applying filters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.predict_from_cfg">
<em class="property">classmethod </em><code class="sig-name descname">predict_from_cfg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">cfgname</span></em>, <em class="sig-param"><span class="n">min_segment_size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.predict_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.predict_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">DataFrame</span></dt><dd><p>The dataframe which contains the columns to use for the estimation.</p>
</dd>
<dt><strong>cfgname</strong><span class="classifier">string</span></dt><dd><p>The name of the yaml config file which describes the hedonic model.</p>
</dd>
<dt><strong>min_segment_size</strong><span class="classifier">int, optional</span></dt><dd><p>Set attribute on the model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>predicted</strong><span class="classifier">pandas.Series</span></dt><dd><p>Predicted data in a pandas Series. Will have the index of <cite>data</cite>
after applying filters and minus any groups that do not have
models.</p>
</dd>
<dt><strong>hm</strong><span class="classifier">SegmentedRegressionModel which was used to predict</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.to_dict">
<code class="sig-name descname">to_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict representation of this instance suitable for
conversion to YAML.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.to_yaml">
<code class="sig-name descname">to_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">str_or_buffer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.to_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.to_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a model respresentation to YAML.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>str_or_buffer</strong><span class="classifier">str or file like, optional</span></dt><dd><p>By default a YAML string is returned. If a string is
given here the YAML will be written to that file.
If an object with a <code class="docutils literal notranslate"><span class="pre">.write</span></code> method is given the
YAML will be written to that object.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>j</strong><span class="classifier">str</span></dt><dd><p>YAML string if <cite>str_or_buffer</cite> is not given.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="urbansim.models.regression.fit_model">
<code class="sig-prename descclassname">urbansim.models.regression.</code><code class="sig-name descname">fit_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">filters</span></em>, <em class="sig-param"><span class="n">model_expression</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#fit_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.fit_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Use statsmodels OLS to construct a model relation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Data to use for fit. Should contain all the columns
referenced in the <cite>model_expression</cite>.</p>
</dd>
<dt><strong>filters</strong><span class="classifier">list of str</span></dt><dd><p>Any filters to apply before doing the model fit.</p>
</dd>
<dt><strong>model_expression</strong><span class="classifier">str</span></dt><dd><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fit</strong><span class="classifier">statsmodels.regression.linear_model.OLSResults</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="urbansim.models.regression.predict">
<code class="sig-prename descclassname">urbansim.models.regression.</code><code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">filters</span></em>, <em class="sig-param"><span class="n">model_fit</span></em>, <em class="sig-param"><span class="n">ytransform</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply model to new data to predict new dependent values.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>filters</strong><span class="classifier">list of str</span></dt><dd><p>Any filters to apply before doing prediction.</p>
</dd>
<dt><strong>model_fit</strong><span class="classifier">statsmodels.regression.linear_model.OLSResults</span></dt><dd><p>Result of model estimation.</p>
</dd>
<dt><strong>ytransform</strong><span class="classifier">callable, optional</span></dt><dd><p>A function to call on the array of predicted output.
For example, if the model relation is predicting the log
of price, you might pass <code class="docutils literal notranslate"><span class="pre">ytransform=np.exp</span></code> so that
the results reflect actual price.</p>
<p>By default no transformation is applied.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier">pandas.Series</span></dt><dd><p>Predicted values as a pandas Series. Will have the index of <cite>df</cite>
after applying filters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-urbansim.models.dcm">
<span id="discrete-choice-api-docs"></span><h3>Discrete Choice API Docs<a class="headerlink" href="#module-urbansim.models.dcm" title="Permalink to this headline">¶</a></h3>
<p>Use the <code class="docutils literal notranslate"><span class="pre">MNLDiscreteChoiceModel</span></code> class to train a choice module using
multinomial logit and make subsequent choice predictions.</p>
<dl class="py class">
<dt id="urbansim.models.dcm.DiscreteChoiceModel">
<em class="property">class </em><code class="sig-prename descclassname">urbansim.models.dcm.</code><code class="sig-name descname">DiscreteChoiceModel</code><a class="reference internal" href="../_modules/urbansim/models/dcm.html#DiscreteChoiceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.DiscreteChoiceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class for discrete choice models.</p>
</dd></dl>

<dl class="py class">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel">
<em class="property">class </em><code class="sig-prename descclassname">urbansim.models.dcm.</code><code class="sig-name descname">MNLDiscreteChoiceModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_expression</span></em>, <em class="sig-param"><span class="n">sample_size</span></em>, <em class="sig-param"><span class="n">probability_mode</span><span class="o">=</span><span class="default_value">'full_product'</span></em>, <em class="sig-param"><span class="n">choice_mode</span><span class="o">=</span><span class="default_value">'individual'</span></em>, <em class="sig-param"><span class="n">choosers_fit_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">choosers_predict_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alts_fit_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alts_predict_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">interaction_predict_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">estimation_sample_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prediction_sample_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">choice_column</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A discrete choice model with the ability to store an estimated
model and predict new data based on the model.
Based on multinomial logit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_expression</strong><span class="classifier">str, iterable, or dict</span></dt><dd><p>A patsy model expression. Should contain only a right-hand side.</p>
</dd>
<dt><strong>sample_size</strong><span class="classifier">int</span></dt><dd><p>Number of choices to sample for estimating the model.</p>
</dd>
<dt><strong>probability_mode</strong><span class="classifier">str, optional</span></dt><dd><p>Specify the method to use for calculating probabilities
during prediction.
Available string options are ‘single_chooser’ and ‘full_product’.
In “single chooser” mode one agent is chosen for calculating
probabilities across all alternatives. In “full product” mode
probabilities are calculated for every chooser across all alternatives.
Currently “single chooser” mode must be used with a <cite>choice_mode</cite>
of ‘aggregate’ and “full product” mode must be used with a
<cite>choice_mode</cite> of ‘individual’.</p>
</dd>
<dt><strong>choice_mode</strong><span class="classifier">str, optional</span></dt><dd><p>Specify the method to use for making choices among alternatives.
Available string options are ‘individual’ and ‘aggregate’.
In “individual” mode choices will be made separately for each chooser.
In “aggregate” mode choices are made for all choosers at once.
Aggregate mode implies that an alternative chosen by one agent
is unavailable to other agents and that the same probabilities
can be used for all choosers.
Currently “individual” mode must be used with a <cite>probability_mode</cite>
of ‘full_product’ and “aggregate” mode must be used with a
<cite>probability_mode</cite> of ‘single_chooser’.</p>
</dd>
<dt><strong>choosers_fit_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to choosers table before fitting the model.</p>
</dd>
<dt><strong>choosers_predict_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the choosers table before calculating
new data points.</p>
</dd>
<dt><strong>alts_fit_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the alternatives table before fitting the model.</p>
</dd>
<dt><strong>alts_predict_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the alternatives table before calculating
new data points.</p>
</dd>
<dt><strong>interaction_predict_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the merged choosers/alternatives table
before predicting agent choices.</p>
</dd>
<dt><strong>estimation_sample_size</strong><span class="classifier">int, optional</span></dt><dd><p>Whether to sample choosers during estimation
(needs to be applied after choosers_fit_filters).</p>
</dd>
<dt><strong>prediction_sample_size</strong><span class="classifier">int, optional</span></dt><dd><p>Whether (and how much) to sample alternatives during prediction.
Note that this can lead to multiple choosers picking the same
alternative.</p>
</dd>
<dt><strong>choice_column</strong><span class="classifier">optional</span></dt><dd><p>Name of the column in the <cite>alternatives</cite> table that choosers
should choose. e.g. the ‘building_id’ column. If not provided
the alternatives index is used.</p>
</dd>
<dt><strong>name</strong><span class="classifier">optional</span></dt><dd><p>Optional descriptive name for this model that may be used
in output.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.alts_columns_used">
<code class="sig-name descname">alts_columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.alts_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.alts_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the alternatives table that are used for filtering.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.apply_fit_filters">
<code class="sig-name descname">apply_fit_filters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.apply_fit_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.apply_fit_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>filtered_choosers, filtered_alts</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.apply_predict_filters">
<code class="sig-name descname">apply_predict_filters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.apply_predict_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.apply_predict_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>filtered_choosers, filtered_alts</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.assert_fitted">
<code class="sig-name descname">assert_fitted</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.assert_fitted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.assert_fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises <cite>RuntimeError</cite> if the model is not ready for prediction.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.choosers_columns_used">
<code class="sig-name descname">choosers_columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.choosers_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.choosers_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the choosers table that are used for filtering.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.columns_used">
<code class="sig-name descname">columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from any table used in the model. May come from either
the choosers or alternatives tables.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">current_choice</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and save model parameters based on given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</dd>
<dt><strong>current_choice</strong><span class="classifier">pandas.Series or any</span></dt><dd><p>A Series describing the <cite>alternatives</cite> currently chosen
by the <cite>choosers</cite>. Should have an index matching <cite>choosers</cite>
and values matching the index of <cite>alternatives</cite>.</p>
<p>If a non-Series is given it should be a column in <cite>choosers</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>log_likelihoods</strong><span class="classifier">dict</span></dt><dd><p>Dict of log-liklihood values describing the quality of the
model fit. Will have keys ‘null’, ‘convergence’, and ‘ratio’.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.fit_from_cfg">
<em class="property">classmethod </em><code class="sig-name descname">fit_from_cfg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">chosen_fname</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">cfgname</span></em>, <em class="sig-param"><span class="n">outcfgname</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.fit_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.fit_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">DataFrame</span></dt><dd><p>A dataframe in which rows represent choosers.</p>
</dd>
<dt><strong>chosen_fname</strong><span class="classifier">string</span></dt><dd><p>A string indicating the column in the choosers dataframe which
gives which alternatives the choosers have chosen.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">DataFrame</span></dt><dd><p>A table of alternatives. It should include the choices
from the choosers table as well as other alternatives from
which to sample.  Values in choosers[chosen_fname] should index
into the alternatives dataframe.</p>
</dd>
<dt><strong>cfgname</strong><span class="classifier">string</span></dt><dd><p>The name of the yaml config file from which to read the discrete
choice model.</p>
</dd>
<dt><strong>outcfgname</strong><span class="classifier">string, optional (default cfgname)</span></dt><dd><p>The name of the output yaml config file where estimation results are written into.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lcm</strong><span class="classifier">MNLDiscreteChoiceModel which was used to fit</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.fitted">
<em class="property">property </em><code class="sig-name descname">fitted</code><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>True if model is ready for prediction.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.from_yaml">
<em class="property">classmethod </em><code class="sig-name descname">from_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">yaml_str</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">str_or_buffer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a DiscreteChoiceModel instance from a saved YAML configuration.
Arguments are mutally exclusive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>yaml_str</strong><span class="classifier">str, optional</span></dt><dd><p>A YAML string from which to load model.</p>
</dd>
<dt><strong>str_or_buffer</strong><span class="classifier">str or file like, optional</span></dt><dd><p>File name or buffer from which to load YAML.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>MNLDiscreteChoiceModel</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.interaction_columns_used">
<code class="sig-name descname">interaction_columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.interaction_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.interaction_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the interaction dataset used for filtering and in
the model. These may come originally from either the choosers or
alternatives tables.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose from among alternatives for a group of agents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool</span></dt><dd><p>If debug is set to true, will set the variable “sim_pdf” on
the object to store the probabilities for mapping of the
outcome.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>choices</strong><span class="classifier">pandas.Series</span></dt><dd><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.predict_from_cfg">
<em class="property">classmethod </em><code class="sig-name descname">predict_from_cfg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">cfgname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cfg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alternative_ratio</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.predict_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.predict_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate choices for the specified choosers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">DataFrame</span></dt><dd><p>A dataframe of agents doing the choosing.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">DataFrame</span></dt><dd><p>A dataframe of locations which the choosers are locating in and
which have a supply.</p>
</dd>
<dt><strong>cfgname</strong><span class="classifier">string</span></dt><dd><p>The name of the yaml config file from which to read the discrete
choice model.</p>
</dd>
<dt><strong>cfg: string</strong></dt><dd><p>an ordered yaml string of the model discrete choice model configuration.
Used to read config from memory in lieu of loading cfgname from disk.</p>
</dd>
<dt><strong>alternative_ratio</strong><span class="classifier">float, optional</span></dt><dd><p>Above the ratio of alternatives to choosers (default of 2.0),
the alternatives will be sampled to meet this ratio
(for performance reasons).</p>
</dd>
<dt><strong>debug</strong><span class="classifier">boolean, optional (default False)</span></dt><dd><p>Whether to generate debug information on the model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>choices</strong><span class="classifier">pandas.Series</span></dt><dd><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</dd>
<dt><strong>lcm</strong><span class="classifier">MNLDiscreteChoiceModel which was used to predict</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.probabilities">
<code class="sig-name descname">probabilities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">filter_tables</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the probabilities for a set of choosers to choose
from among a set of alternatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing.</p>
</dd>
<dt><strong>filter_tables</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, filter <cite>choosers</cite> and <cite>alternatives</cite> with prediction
filters before calculating probabilities.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>probabilities</strong><span class="classifier">pandas.Series</span></dt><dd><p>Probability of selection associated with each chooser
and alternative. Index will be a MultiIndex with alternative
IDs in the inner index and chooser IDs in the out index.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.report_fit">
<code class="sig-name descname">report_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.report_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.report_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a report of the fit results.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.str_model_expression">
<em class="property">property </em><code class="sig-name descname">str_model_expression</code><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.str_model_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Model expression as a string suitable for use with patsy/statsmodels.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.summed_probabilities">
<code class="sig-name descname">summed_probabilities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.summed_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.summed_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate total probability associated with each alternative.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>probs</strong><span class="classifier">pandas.Series</span></dt><dd><p>Total probability associated with each alternative.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.to_dict">
<code class="sig-name descname">to_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dict respresentation of an MNLDiscreteChoiceModel
instance.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.to_yaml">
<code class="sig-name descname">to_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">str_or_buffer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.to_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.to_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a model respresentation to YAML.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>str_or_buffer</strong><span class="classifier">str or file like, optional</span></dt><dd><p>By default a YAML string is returned. If a string is
given here the YAML will be written to that file.
If an object with a <code class="docutils literal notranslate"><span class="pre">.write</span></code> method is given the
YAML will be written to that object.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>j</strong><span class="classifier">str</span></dt><dd><p>YAML is string if <cite>str_or_buffer</cite> is not given.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup">
<em class="property">class </em><code class="sig-prename descclassname">urbansim.models.dcm.</code><code class="sig-name descname">MNLDiscreteChoiceModelGroup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">segmentation_col</span></em>, <em class="sig-param"><span class="n">remove_alts</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Manages a group of discrete choice models that refer to different
segments of choosers.</p>
<p>Model names must match the segment names after doing a pandas groupby.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>segmentation_col</strong><span class="classifier">str</span></dt><dd><p>Name of a column in the table of choosers. Will be used to perform
a pandas groupby on the choosers table.</p>
</dd>
<dt><strong>remove_alts</strong><span class="classifier">bool, optional</span></dt><dd><p>Specify how to handle alternatives between prediction for different
models. If False, the alternatives table is not modified between
predictions. If True, alternatives that have been chosen
are removed from the alternatives table before doing another
round of prediction.</p>
</dd>
<dt><strong>name</strong><span class="classifier">str, optional</span></dt><dd><p>A name that may be used in places to identify this group.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.add_model">
<code class="sig-name descname">add_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">model</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.add_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.add_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an MNLDiscreteChoiceModel instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model</strong><span class="classifier">MNLDiscreteChoiceModel</span></dt><dd><p>Should have a <code class="docutils literal notranslate"><span class="pre">.name</span></code> attribute matching one of the segments
in the choosers table.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.add_model_from_params">
<code class="sig-name descname">add_model_from_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">model_expression</span></em>, <em class="sig-param"><span class="n">sample_size</span></em>, <em class="sig-param"><span class="n">probability_mode</span><span class="o">=</span><span class="default_value">'full_product'</span></em>, <em class="sig-param"><span class="n">choice_mode</span><span class="o">=</span><span class="default_value">'individual'</span></em>, <em class="sig-param"><span class="n">choosers_fit_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">choosers_predict_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alts_fit_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alts_predict_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">interaction_predict_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">estimation_sample_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prediction_sample_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">choice_column</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.add_model_from_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.add_model_from_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a model by passing parameters through to MNLDiscreteChoiceModel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong></dt><dd><p>Must match a segment in the choosers table.</p>
</dd>
<dt><strong>model_expression</strong><span class="classifier">str, iterable, or dict</span></dt><dd><p>A patsy model expression. Should contain only a right-hand side.</p>
</dd>
<dt><strong>sample_size</strong><span class="classifier">int</span></dt><dd><p>Number of choices to sample for estimating the model.</p>
</dd>
<dt><strong>probability_mode</strong><span class="classifier">str, optional</span></dt><dd><p>Specify the method to use for calculating probabilities
during prediction.
Available string options are ‘single_chooser’ and ‘full_product’.
In “single chooser” mode one agent is chosen for calculating
probabilities across all alternatives. In “full product” mode
probabilities are calculated for every chooser across all
alternatives.</p>
</dd>
<dt><strong>choice_mode</strong><span class="classifier">str or callable, optional</span></dt><dd><p>Specify the method to use for making choices among alternatives.
Available string options are ‘individual’ and ‘aggregate’.
In “individual” mode choices will be made separately for each
chooser. In “aggregate” mode choices are made for all choosers at
once. Aggregate mode implies that an alternative chosen by one
agent is unavailable to other agents and that the same
probabilities can be used for all choosers.</p>
</dd>
<dt><strong>choosers_fit_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to choosers table before fitting the model.</p>
</dd>
<dt><strong>choosers_predict_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the choosers table before calculating
new data points.</p>
</dd>
<dt><strong>alts_fit_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the alternatives table before fitting the model.</p>
</dd>
<dt><strong>alts_predict_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the alternatives table before calculating
new data points.</p>
</dd>
<dt><strong>interaction_predict_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the merged choosers/alternatives table
before predicting agent choices.</p>
</dd>
<dt><strong>estimation_sample_size</strong><span class="classifier">int, optional</span></dt><dd><p>Whether to sample choosers during estimation
(needs to be applied after choosers_fit_filters)</p>
</dd>
<dt><strong>prediction_sample_size</strong><span class="classifier">int, optional</span></dt><dd><p>Whether (and how much) to sample alternatives during prediction.
Note that this can lead to multiple choosers picking the same
alternative.</p>
</dd>
<dt><strong>choice_column</strong><span class="classifier">optional</span></dt><dd><p>Name of the column in the <cite>alternatives</cite> table that choosers
should choose. e.g. the ‘building_id’ column. If not provided
the alternatives index is used.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.alts_columns_used">
<code class="sig-name descname">alts_columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.alts_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.alts_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the alternatives table that are used for filtering.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.apply_fit_filters">
<code class="sig-name descname">apply_fit_filters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.apply_fit_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.apply_fit_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for fitting.
This is done by filtering each submodel and concatenating
the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>filtered_choosers, filtered_alts</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.apply_predict_filters">
<code class="sig-name descname">apply_predict_filters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.apply_predict_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.apply_predict_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for prediction.
This is done by filtering each submodel and concatenating
the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>filtered_choosers, filtered_alts</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.choosers_columns_used">
<code class="sig-name descname">choosers_columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.choosers_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.choosers_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the choosers table that are used for filtering.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.columns_used">
<code class="sig-name descname">columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from any table used in the model. May come from either
the choosers or alternatives tables.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">current_choice</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and save models based on given data after segmenting
the <cite>choosers</cite> table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.
Must have a column with the same name as the .segmentation_col
attribute.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</dd>
<dt><strong>current_choice</strong></dt><dd><p>Name of column in <cite>choosers</cite> that indicates which alternative
they have currently chosen.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>log_likelihoods</strong><span class="classifier">dict of dict</span></dt><dd><p>Keys will be model names and values will be dictionaries of
log-liklihood values as returned by MNLDiscreteChoiceModel.fit.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.fitted">
<em class="property">property </em><code class="sig-name descname">fitted</code><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether all models in the group have been fitted.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.interaction_columns_used">
<code class="sig-name descname">interaction_columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.interaction_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.interaction_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the interaction dataset used for filtering and in
the model. These may come originally from either the choosers or
alternatives tables.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose from among alternatives for a group of agents after
segmenting the <cite>choosers</cite> table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool</span></dt><dd><p>If debug is set to true, will set the variable “sim_pdf” on
the object to store the probabilities for mapping of the
outcome.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>choices</strong><span class="classifier">pandas.Series</span></dt><dd><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.probabilities">
<code class="sig-name descname">probabilities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns alternative probabilties for each chooser segment as
a dictionary keyed by segment name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>probabilties</strong><span class="classifier">dict of pandas.Series</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.summed_probabilities">
<code class="sig-name descname">summed_probabilities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.summed_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.summed_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sum of probabilities for alternatives across all
chooser segments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>probs</strong><span class="classifier">pandas.Series</span></dt><dd><p>Summed probabilities from each segment added together.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel">
<em class="property">class </em><code class="sig-prename descclassname">urbansim.models.dcm.</code><code class="sig-name descname">SegmentedMNLDiscreteChoiceModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">segmentation_col</span></em>, <em class="sig-param"><span class="n">sample_size</span></em>, <em class="sig-param"><span class="n">probability_mode</span><span class="o">=</span><span class="default_value">'full_product'</span></em>, <em class="sig-param"><span class="n">choice_mode</span><span class="o">=</span><span class="default_value">'individual'</span></em>, <em class="sig-param"><span class="n">choosers_fit_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">choosers_predict_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alts_fit_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alts_predict_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">interaction_predict_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">estimation_sample_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prediction_sample_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">choice_column</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">default_model_expr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">remove_alts</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>An MNL LCM group that allows segments to have different model expressions
but otherwise share configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>segmentation_col</strong></dt><dd><p>Name of column in the choosers table that will be used for groupby.</p>
</dd>
<dt><strong>sample_size</strong><span class="classifier">int</span></dt><dd><p>Number of choices to sample for estimating the model.</p>
</dd>
<dt><strong>probability_mode</strong><span class="classifier">str, optional</span></dt><dd><p>Specify the method to use for calculating probabilities
during prediction.
Available string options are ‘single_chooser’ and ‘full_product’.
In “single chooser” mode one agent is chosen for calculating
probabilities across all alternatives. In “full product” mode
probabilities are calculated for every chooser across all alternatives.
Currently “single chooser” mode must be used with a <cite>choice_mode</cite>
of ‘aggregate’ and “full product” mode must be used with a
<cite>choice_mode</cite> of ‘individual’.</p>
</dd>
<dt><strong>choice_mode</strong><span class="classifier">str, optional</span></dt><dd><p>Specify the method to use for making choices among alternatives.
Available string options are ‘individual’ and ‘aggregate’.
In “individual” mode choices will be made separately for each chooser.
In “aggregate” mode choices are made for all choosers at once.
Aggregate mode implies that an alternative chosen by one agent
is unavailable to other agents and that the same probabilities
can be used for all choosers.
Currently “individual” mode must be used with a <cite>probability_mode</cite>
of ‘full_product’ and “aggregate” mode must be used with a
<cite>probability_mode</cite> of ‘single_chooser’.</p>
</dd>
<dt><strong>choosers_fit_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to choosers table before fitting the model.</p>
</dd>
<dt><strong>choosers_predict_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the choosers table before calculating
new data points.</p>
</dd>
<dt><strong>alts_fit_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the alternatives table before fitting the model.</p>
</dd>
<dt><strong>alts_predict_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the alternatives table before calculating
new data points.</p>
</dd>
<dt><strong>interaction_predict_filters</strong><span class="classifier">list of str, optional</span></dt><dd><p>Filters applied to the merged choosers/alternatives table
before predicting agent choices.</p>
</dd>
<dt><strong>estimation_sample_size</strong><span class="classifier">int, optional</span></dt><dd><p>Whether to sample choosers during estimation
(needs to be applied after choosers_fit_filters)</p>
</dd>
<dt><strong>prediction_sample_size</strong><span class="classifier">int, optional</span></dt><dd><p>Whether (and how much) to sample alternatives during prediction.
Note that this can lead to multiple choosers picking the same
alternative.</p>
</dd>
<dt><strong>choice_column</strong><span class="classifier">optional</span></dt><dd><p>Name of the column in the <cite>alternatives</cite> table that choosers
should choose. e.g. the ‘building_id’ column. If not provided
the alternatives index is used.</p>
</dd>
<dt><strong>default_model_expr</strong><span class="classifier">str, iterable, or dict, optional</span></dt><dd><p>A patsy model expression. Should contain only a right-hand side.</p>
</dd>
<dt><strong>remove_alts</strong><span class="classifier">bool, optional</span></dt><dd><p>Specify how to handle alternatives between prediction for different
models. If False, the alternatives table is not modified between
predictions. If True, alternatives that have been chosen
are removed from the alternatives table before doing another
round of prediction.</p>
</dd>
<dt><strong>name</strong><span class="classifier">str, optional</span></dt><dd><p>An optional string used to identify the model in places.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.add_segment">
<code class="sig-name descname">add_segment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">model_expression</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.add_segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.add_segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new segment with its own model expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong></dt><dd><p>Segment name. Must match a segment in the groupby of the data.</p>
</dd>
<dt><strong>model_expression</strong><span class="classifier">str or dict, optional</span></dt><dd><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.
If not given the default model will be used, which must not be
None.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.alts_columns_used">
<code class="sig-name descname">alts_columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.alts_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.alts_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the alternatives table that are used for filtering.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.apply_fit_filters">
<code class="sig-name descname">apply_fit_filters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.apply_fit_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.apply_fit_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>filtered_choosers, filtered_alts</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.apply_predict_filters">
<code class="sig-name descname">apply_predict_filters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.apply_predict_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.apply_predict_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>filtered_choosers, filtered_alts</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.choosers_columns_used">
<code class="sig-name descname">choosers_columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.choosers_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.choosers_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the choosers table that are used for filtering.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.columns_used">
<code class="sig-name descname">columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from any table used in the model. May come from either
the choosers or alternatives tables.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">current_choice</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and save models based on given data after segmenting
the <cite>choosers</cite> table. Segments that have not already been explicitly
added will be automatically added with default model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.
Must have a column with the same name as the .segmentation_col
attribute.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</dd>
<dt><strong>current_choice</strong></dt><dd><p>Name of column in <cite>choosers</cite> that indicates which alternative
they have currently chosen.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>log_likelihoods</strong><span class="classifier">dict of dict</span></dt><dd><p>Keys will be model names and values will be dictionaries of
log-liklihood values as returned by MNLDiscreteChoiceModel.fit.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fit_from_cfg">
<em class="property">classmethod </em><code class="sig-name descname">fit_from_cfg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">chosen_fname</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">cfgname</span></em>, <em class="sig-param"><span class="n">outcfgname</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.fit_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fit_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">DataFrame</span></dt><dd><p>A dataframe of rows of agents that have made choices.</p>
</dd>
<dt><strong>chosen_fname</strong><span class="classifier">string</span></dt><dd><p>A string indicating the column in the choosers dataframe which
gives which alternative the choosers have chosen.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">DataFrame</span></dt><dd><p>A dataframe of alternatives. It should include the current choices
from the choosers dataframe as well as some other alternatives from
which to sample.  Values in choosers[chosen_fname] should index
into the alternatives dataframe.</p>
</dd>
<dt><strong>cfgname</strong><span class="classifier">string</span></dt><dd><p>The name of the yaml config file from which to read the discrete
choice model.</p>
</dd>
<dt><strong>outcfgname</strong><span class="classifier">string, optional (default cfgname)</span></dt><dd><p>The name of the output yaml config file where estimation results are written into.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lcm</strong><span class="classifier">SegmentedMNLDiscreteChoiceModel which was used to fit</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fitted">
<em class="property">property </em><code class="sig-name descname">fitted</code><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether models for all segments have been fit.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.from_yaml">
<em class="property">classmethod </em><code class="sig-name descname">from_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">yaml_str</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">str_or_buffer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a SegmentedMNLDiscreteChoiceModel instance from a saved YAML
configuration. Arguments are mutally exclusive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>yaml_str</strong><span class="classifier">str, optional</span></dt><dd><p>A YAML string from which to load model.</p>
</dd>
<dt><strong>str_or_buffer</strong><span class="classifier">str or file like, optional</span></dt><dd><p>File name or buffer from which to load YAML.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>SegmentedMNLDiscreteChoiceModel</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.interaction_columns_used">
<code class="sig-name descname">interaction_columns_used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.interaction_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.interaction_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the interaction dataset used for filtering and in
the model. These may come originally from either the choosers or
alternatives tables.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose from among alternatives for a group of agents after
segmenting the <cite>choosers</cite> table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool</span></dt><dd><p>If debug is set to true, will set the variable “sim_pdf” on
the object to store the probabilities for mapping of the
outcome.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>choices</strong><span class="classifier">pandas.Series</span></dt><dd><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.predict_from_cfg">
<em class="property">classmethod </em><code class="sig-name descname">predict_from_cfg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em>, <em class="sig-param"><span class="n">cfgname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cfg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alternative_ratio</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.predict_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.predict_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate the discrete choices for the specified choosers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">DataFrame</span></dt><dd><p>A dataframe of agents doing the choosing.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">DataFrame</span></dt><dd><p>A dataframe of alternatives which the choosers are locating in and
which have a supply.</p>
</dd>
<dt><strong>cfgname</strong><span class="classifier">string</span></dt><dd><p>The name of the yaml config file from which to read the discrete
choice model.</p>
</dd>
<dt><strong>cfg: string</strong></dt><dd><p>an ordered yaml string of the model discrete choice model configuration.
Used to read config from memory in lieu of loading cfgname from disk.</p>
</dd>
<dt><strong>alternative_ratio</strong><span class="classifier">float</span></dt><dd><p>Above the ratio of alternatives to choosers (default of 2.0),
the alternatives will be sampled to meet this ratio
(for performance reasons).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>choices</strong><span class="classifier">pandas.Series</span></dt><dd><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</dd>
<dt><strong>lcm</strong><span class="classifier">SegmentedMNLDiscreteChoiceModel which was used to predict</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.probabilities">
<code class="sig-name descname">probabilities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns alternative probabilties for each chooser segment as
a dictionary keyed by segment name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>probabilties</strong><span class="classifier">dict of pandas.Series</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.summed_probabilities">
<code class="sig-name descname">summed_probabilities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">choosers</span></em>, <em class="sig-param"><span class="n">alternatives</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.summed_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.summed_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sum of probabilities for alternatives across all
chooser segments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>choosers</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</dd>
<dt><strong>alternatives</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Table describing the things from which agents are choosing.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>probs</strong><span class="classifier">pandas.Series</span></dt><dd><p>Summed probabilities from each segment added together.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.to_dict">
<code class="sig-name descname">to_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict representation of this instance suitable for
conversion to YAML.</p>
</dd></dl>

<dl class="py method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.to_yaml">
<code class="sig-name descname">to_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">str_or_buffer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.to_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.to_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a model respresentation to YAML.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>str_or_buffer</strong><span class="classifier">str or file like, optional</span></dt><dd><p>By default a YAML string is returned. If a string is
given here the YAML will be written to that file.
If an object with a <code class="docutils literal notranslate"><span class="pre">.write</span></code> method is given the
YAML will be written to that object.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>j</strong><span class="classifier">str</span></dt><dd><p>YAML is string if <cite>str_or_buffer</cite> is not given.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="urbansim.models.dcm.unit_choice">
<code class="sig-prename descclassname">urbansim.models.dcm.</code><code class="sig-name descname">unit_choice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">chooser_ids</span></em>, <em class="sig-param"><span class="n">alternative_ids</span></em>, <em class="sig-param"><span class="n">probabilities</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#unit_choice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.unit_choice" title="Permalink to this definition">¶</a></dt>
<dd><p>Have a set of choosers choose from among alternatives according
to a probability distribution. Choice is binary: each
alternative can only be chosen once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chooser_ids</strong><span class="classifier">1d array_like</span></dt><dd><p>Array of IDs of the agents that are making choices.</p>
</dd>
<dt><strong>alternative_ids</strong><span class="classifier">1d array_like</span></dt><dd><p>Array of IDs of alternatives among which agents are making choices.</p>
</dd>
<dt><strong>probabilities</strong><span class="classifier">1d array_like</span></dt><dd><p>The probability that an agent will choose an alternative.
Must be the same shape as <cite>alternative_ids</cite>. Unavailable
alternatives should have a probability of 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>choices</strong><span class="classifier">pandas.Series</span></dt><dd><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="supplydemand.html" class="btn btn-neutral float-right" title="Supply and Demand Accounting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Core Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, UrbanSim Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>